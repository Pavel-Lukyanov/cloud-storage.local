# cloud-storage.local

1) Подключение к БД инициализируется в файле index.php в корне проекта.

2) Регистрация пользователя осуществляется по маршруту /user/ - метод POST. Для регистрации необходимо отправить запрос в формате JSON и передать данные: email, password, role, где role равна "admin". 
Т.к в некоторых методах идет проверка на роль admin. В результате успешного добавления пользователя сервер вернет id, email и role добавленного пользователя.

3) Аутенификация пользователя происходит по маршруту /login/, метод запроса POST, отправляемые данные в формате JSON - email и password, при успешной аутентификации сервер вернет токен авторизации, дату жизни токена и тип токена Bearer.
Токен неободимо будет копировать и вставить в postman во вкладке Authorization, выбрав тип Bearer token.

4) Получить всех пользователей зарегистрированны в системе, можно отправив GET запрос по маршруту /user/.

5) Обновить данные о пользователе можно отправив PUT запрос в формате JSON на маршрут /user/. В теле запроса необходимо указать email и role пользователя. Пароль нельзя обновить, его можно только сбросить через почту.

6) Удалить пользователя можно по маршруту /user/{id}, метод запроса DELETE, Content-Type: application'json. Вместо id необходимо вставить число (id пользователя в базе данных в формате: "/user/12").
При успешном удалении сервер вернет 204 статус код.

7) Выход из аккаунта, необходимо отправить запрос по маршруту /logout/, метод запроса GET. В заголовках авторизации необходим токен, который был выдан при аутентификации. В случае успешного запроса, сервер вернет код 200.

8) Сброс пароля. Для сброса пароля необходимо отправить запрос типа POST на маршрут /reset-password/. В теле запроса указать JSON с полем email. На указанный email придет письмо с ссылкой на сброс пароля.
В ссылке будет GET параметр "token". Данный токен необходимо копировать и вставить в тело запроса с названием поля "token", также необходимо создать поле с названием "password", в него поместить новый пароль
И методом POST отправить этот JSON по маршруту /new-password/. Сервер в случае успеха вернет строку "Password changed successfully" и статус код 200.

9) Получить данные пользователя по id. Для получения данных, необходимо отправить GET запрос по маршруту /users/12, где 12 - это id пользователя в БД. В случае успеха сервер вернет id и email пользователя.

10) Метод для просмотра всех пользователей. Чтобы получить всех пользователей необходимо отправить GET запрос по маршруту "/admin/user/". При этом проверяется токен авторизации и роль пользователя. Необходимо чтобы роль была "admin" и пользователь был авторизован.

11) Удалить пользователя, метод для администратора. Необходимо иметь роль "admin" и быть авторизованным.
Для удаления необходимо отправить запрос "DELETE" по маршруту "/admin/user/12", где 12 - id пользователя, которого нужно удалить. В случае успеха сервер вернет 204 статус код.

12) Обновить данные пользователя, метод для администратора. Необходимо иметь роль "admin" и быть авторизованным.
Для уобновления данных необходимо отправить запрос метода PUT, по маршруту "/admin/user/" в формате JSON. В теле запроса вложить новый "email" пользователя, "id" пользователя которого нужно изменить и новую "role" пользователя.
В случае успеха сервер вернет обновленные данные о пользователе.

13) Добавление файла. Для добавления файла необходимо отправить POST запрос на маршрут /file/ в формате form-data. Сам файл должен быть с расширениями jpeg, png, pdf и весом не более 2GB. 

14) В теле запроса приложить файл в поле с названием "file" и поле с названием "folder_id", в значении которого указать id папки, в которую хотите добавить файл. 
У каждого пользователя при регистрации создается папка с названием его id. Если файл добавляется в корневую папку пользователя, то необходимо указать id пользователя в folder_id. Иначе id вложенной папки.
В случае успеха, сервер вернет статус код 200 и строку "Файл успешно загружен".

15) Для вывода всех файлов пользователя, необходимо быть авторизованным и отправить GET запрос на маршрут /file/, в случае успеха сервер вернет массив files с названиями файлов принадлежащие пользователю.

16) Вывод информацию об определенном файле. Необходимо быть авторизованным и отправить запрос GET запрос на маршрут /file/12, где 12 - это id файла в БД. В случае успеха, сервер вернет подробные данные о файле, типа, размер, название.

17) Перемещение файла в другую папку. Для перемещения необходимо быть авторизованным, файл должен принадлежать пользователю и нужно отправить PUT запрос на маршрут /file/ в формате JSON. 
В теле запроса указать "new_folder_id" - id в БД папки в которую необходимо переместить файл и "file_id" - id файла, который необходимо переместить.

18) Изменение названия файла. Для изменения названия необходимо быть авторизованным, файл должен принадлежать пользователю и нужно отправить PUT запрос на маршрут /file/ в формате JSON. 
В теле запроса указать поля: "file_name" - новое название файла и "file_id", id файла, название которого необходимо изменить. В случае успеха сервер вернет "message": "Success rename file".

19) Удаление файла. Для удаления необходимо быть авториованным и чтобы файл принадлежал пользователю. Чтобы удалить файл, необходимо отправить запрос методом DELETE на маршрут /file/12 - где 12 это id удаляемого файла.
В случае успеха сервер вернет статус код 204.

20) Добавление папки. Для добавления папки необходимо быть авторизованным. Максимальный уровень вложенности папок 1. Т.е есть общая папка /files/ и корневая папка пользователя с его id. 
В ней уже создаются дополнительные папки. Для добавления папки нужно отправить запрос в формате JSON, методом POST на маршрут /directory/. В полях указать "folder_name" - название папки.
В случае успеха сервер вернет название папки и путь к родительской папке.

21) Переименовать папку. Для переименования папки необходимо быть авторизованным и отправить запрос методом PUT в формате JSON на маршрут /directory/. 
В теле запроса указать folder_name - новое имя папки и file_id - id папки из БД. В случае успеха сервер вернет "message": "Folder renamed success".

22) Получение списка файлов. Для получения списка файлов необходимо быть авторизованным и отправить GET запрос на маршрут /directory/12 - где 12 это id папки, содержимое которой хотим узнать.
В случае успеха сервер вернет массив с названиями файлов.

23) Получение списка пользователей имеющих доступ к файлу. Для этого необходимо отправить GET запрос на маршрут /files/share/. Сервер вернет id пользователей, которым предоставлен доступ.

24) Поделиться файлом с другим пользователем. Для этого необходимо отправить PUT запрос на маршрут /files/share/12/23/, где 12 - id пользоателя, которому нужно предоставить доступ, а 23 - id файла, доступ которого предоставляется.

25) Прекратить предоставление доступа. Для этого необходимо отправить DELETE запрос на маршрут /files/share/12/23, где 12 - id пользователя, которому нужно прекратить доступ к файлу, 
а 23 - id файла, доступ к которому необходимо прекратить.




